# 宠物系统 - 手动查询模式

## 当前状态

已移除所有自动播报功能。宠物系统现在仅支持**手动查询模式**。

## 使用方式

用户可以随时主动询问宠物状态：

```
用户："小智"
用户："宠物状态" / "宠物怎么样" / "我的宠物好吗"
AI：调用 self.pet.check_warning 或 self.pet.get_state 工具并播报结果
```

## 技术细节

### 代码状态

- ✅ `CheckWarning()` 恢复到原始版本（有去重逻辑）
- ✅ 移除对话结束后的自动检查
- ✅ 移除 `TriggerAiPetAnnouncement()` 方法
- ✅ 移除 `pending_pet_warning_` 队列变量
- ✅ 保留定时自动播报功能（可选，由 `EnableAutoAnnouncement` 控制）

### MCP工具

保留以下MCP工具供AI调用：

1. **self.pet.get_state** - 获取完整宠物状态
2. **self.pet.check_warning** - 检查是否有警告
3. **self.pet.feed** - 喂食
4. **self.pet.clean** - 清洁
5. **self.pet.play** - 玩耍

### 工作流程

```
用户询问 → AI收到消息 → AI调用MCP工具 → AI自然语言播报
```

## 优势

- ✅ 简单可靠，不依赖复杂的自动触发机制
- ✅ 用户完全掌控，不会被打断
- ✅ AI的 `self.pet.check_warning` 工具描述中已有详细规则
- ✅ 无需额外服务器配置

## 可选：定时播报

如需定时自动播报（例如每15分钟检查一次），可在代码中调用：

```cpp
auto& pet_system = PetSystem::GetInstance();
pet_system.EnableAutoAnnouncement(true, 15);  // 启用，间隔15分钟
```

这会在后台定时检查宠物状态，有问题时播放本地提示音和字幕（不触发AI）。

---

**简洁可靠，用户主动查询即可。**







